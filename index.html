<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Pixboard</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    #canvas {
      border: 1px solid #ccc;
      width: 90vmin;
      height: 90vmin;
      touch-action: none;
    }
  </style>
</head>
<body class="bg-gray-50 text-gray-800">
  <div class="mx-auto p-4 space-y-4 max-w-none">
    <h1 class="text-2xl font-bold">Pixboard</h1>
    <input type="file" id="fileInput" accept="image/*" multiple class="block mb-2">

    <div class="flex flex-wrap gap-2">
      <button class="px-2 py-1 bg-gray-200 rounded" onclick="rotate(-90)">Rotate -90°</button>
      <button class="px-2 py-1 bg-gray-200 rounded" onclick="rotate(90)">Rotate +90°</button>
      <button class="px-2 py-1 bg-gray-200 rounded" onclick="flipX()">Flip Horizontal</button>
      <button class="px-2 py-1 bg-gray-200 rounded" onclick="flipY()">Flip Vertical</button>
      <button class="px-2 py-1 bg-gray-200 rounded" onclick="undo()">Undo</button>
      <button class="px-2 py-1 bg-gray-200 rounded" onclick="redo()">Redo</button>
    </div>

    <div class="flex flex-wrap items-center gap-2">
      <label>Width: <input class="border p-1 w-20" type="number" id="width" value="0"></label>
      <label>Height: <input class="border p-1 w-20" type="number" id="height" value="0"></label>
      <button class="px-2 py-1 bg-gray-200 rounded" onclick="resizeCanvas()">Resize</button>
    </div>

    <h3 class="font-semibold">画像調整</h3>
    <div class="flex items-center gap-2">
      <label>Brightness: <input type="range" id="brightness" min="-100" max="100" value="0" oninput="setBrightness(this.value)"></label>
    </div>
    <div class="flex items-center gap-2">
      <label>Saturation Threshold: <input type="range" id="saturationThreshold" min="0" max="255" value="50" oninput="setSaturationThreshold(this.value)"></label>
    </div>

    <h3 class="font-semibold">フィルター</h3>
    <div id="filter-buttons" class="flex flex-wrap gap-2">
      <button data-filter="none" onclick="setFilter('none')" class="active px-2 py-1 bg-gray-200 rounded">Normal</button>
      <button data-filter="grayscale" onclick="setFilter('grayscale')" class="px-2 py-1 bg-gray-200 rounded">Grayscale</button>
      <button data-filter="sepia" onclick="setFilter('sepia')" class="px-2 py-1 bg-gray-200 rounded">Sepia</button>
      <button data-filter="saturation-gray" onclick="setFilter('saturation-gray')" class="px-2 py-1 bg-gray-200 rounded">Partial Grayscale</button>
    </div>

    <div class="flex flex-wrap gap-2 items-center">
      <input type="text" id="textInput" placeholder="Text" class="border p-1">
      <input type="color" id="textColor" value="#000000">
      <input type="number" id="textSize" value="20" class="border p-1 w-16">
      <button class="px-2 py-1 bg-gray-200 rounded" onclick="enableTextMode()">Add Text</button>
      <button class="px-2 py-1 bg-gray-200 rounded" onclick="enableMaskMode()">Mask Mode</button>
      <button class="px-2 py-1 bg-gray-200 rounded" onclick="batchProcess()">Batch Process</button>
    </div>

    <h3 class="font-semibold">Stickers</h3>
    <div id="sticker-container" class="flex flex-wrap gap-2"></div>

    <div id="layer-controls" class="flex flex-wrap gap-2 items-center hidden">
      <button class="px-2 py-1 bg-gray-200 rounded" onclick="bringForward()">Bring Forward</button>
      <button class="px-2 py-1 bg-gray-200 rounded" onclick="sendBackward()">Send Backward</button>
      <button class="px-2 py-1 bg-red-200 rounded" onclick="deleteLayer()">Delete</button>
      <label>W:<input id="layerWidth" type="number" class="border p-1 w-16" onchange="updateLayerSize()"></label>
      <label>H:<input id="layerHeight" type="number" class="border p-1 w-16" onchange="updateLayerSize()"></label>
      <label>Rot:<input id="layerRotation" type="number" class="border p-1 w-16" onchange="updateLayerRotation()"></label>
    </div>

    <canvas id="canvas" class="mt-2"></canvas>

    <div class="flex flex-wrap gap-2">
      <button class="px-2 py-1 bg-gray-200 rounded" onclick="cropCanvas()">トリミング</button>
      <button class="px-2 py-1 bg-gray-200 rounded" onclick="savePNG()">Save PNG</button>
      <button class="px-2 py-1 bg-gray-200 rounded" onclick="saveJPG()">Save JPG</button>
      <button class="px-2 py-1 bg-gray-200 rounded" onclick="resetEditor()">すべてリセット</button>
    </div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
  <script src="script.js"></script>
</body>
</html>